<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theoretical Background · MriReconstructionToolbox.jl</title><meta name="title" content="Theoretical Background · MriReconstructionToolbox.jl"/><meta property="og:title" content="Theoretical Background · MriReconstructionToolbox.jl"/><meta property="twitter:title" content="Theoretical Background · MriReconstructionToolbox.jl"/><meta name="description" content="Documentation for MriReconstructionToolbox.jl."/><meta property="og:description" content="Documentation for MriReconstructionToolbox.jl."/><meta property="twitter:description" content="Documentation for MriReconstructionToolbox.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.svg" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="MriReconstructionToolbox.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="MriReconstructionToolbox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MriReconstructionToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Theoretical Background</a><ul class="internal"><li><a class="tocitem" href="#MRI-Forward-Model"><span>MRI Forward Model</span></a></li><li><a class="tocitem" href="#Reconstruction-as-Inverse-Problem"><span>Reconstruction as Inverse Problem</span></a></li></ul></li><li><span class="tocitem">High-level Interface</span><ul><li><a class="tocitem" href="../high-level/acquisition_info/">AcquisitionInfo</a></li><li><a class="tocitem" href="../high-level/simulation/">Simulation Tools</a></li><li><a class="tocitem" href="../high-level/reconstruction/">Reconstruction</a></li><li><a class="tocitem" href="../high-level/regularization/">Regularization</a></li><li><a class="tocitem" href="../high-level/algorithms/">Optimization Algorithms</a></li><li><a class="tocitem" href="../high-level/nameddims/">Named Dimensions</a></li><li><a class="tocitem" href="../high-level/decomposition/">Problem Decomposition</a></li></ul></li><li><span class="tocitem">Low-Level Interface</span><ul><li><a class="tocitem" href="../low-level/operators/">MRI Operators</a></li><li><a class="tocitem" href="../low-level/custom_reconstruction/">Custom Reconstruction</a></li><li><a class="tocitem" href="../low-level/abstract_operators/">AbstractOperators.jl</a></li><li><a class="tocitem" href="../low-level/proximal_operators/">ProximalOperators.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theoretical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theoretical Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hakkelt/MriReconstructionToolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hakkelt/MriReconstructionToolbox.jl/blob/master/docs/src/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Theoretical-Background"><a class="docs-heading-anchor" href="#Theoretical-Background">Theoretical Background</a><a id="Theoretical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-Background" title="Permalink"></a></h1><h2 id="MRI-Forward-Model"><a class="docs-heading-anchor" href="#MRI-Forward-Model">MRI Forward Model</a><a id="MRI-Forward-Model-1"></a><a class="docs-heading-anchor-permalink" href="#MRI-Forward-Model" title="Permalink"></a></h2><p>The MRI forward model describes how an image transforms into observed k-space data:</p><p class="math-container">\[y = \Gamma \mathcal{F} \mathcal{S} x + n\]</p><p>Where:</p><ul><li><span>$x \in \mathbb{C}^{N_x \times N_y \times [N_z]}$</span> is the image to be reconstructed</li><li><span>$\mathcal{S}$</span> represents coil sensitivity weighting operator</li><li><span>$\mathcal{F}$</span> is the Fourier transform operator</li><li><span>$\Gamma$</span> is the subsampling operator</li><li><span>$y$</span> is the observed k-space data</li><li><span>$n$</span> is measurement noise</li></ul><p>These operators are all linear maps, and they are usually represented as complex matrices in the literature. Even though, in practice, we implement them as efficient computational operators without explicitly forming large matrices, it gives theoretical background for defining adjoint operations (complex conjugate of transpose for matrices) that are essential for iterative reconstruction algorithms.</p><h3 id="Operator-Components"><a class="docs-heading-anchor" href="#Operator-Components">Operator Components</a><a id="Operator-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Operator-Components" title="Permalink"></a></h3><h4 id="1.-Sensitivity-Map-Operator-(S)"><a class="docs-heading-anchor" href="#1.-Sensitivity-Map-Operator-(S)">1. Sensitivity Map Operator (S)</a><a id="1.-Sensitivity-Map-Operator-(S)-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Sensitivity-Map-Operator-(S)" title="Permalink"></a></h4><p>Models the spatial sensitivity of receiver coils in parallel imaging:</p><p class="math-container">\[S: \mathbb{C}^{N_x \times N_y \times [N_z]} \rightarrow \mathbb{C}^{N_x \times N_y \times [N_z] \times N_c}\]</p><p><strong>Forward operation</strong>: <span>$(Sx)_c = s_c \odot x$</span> (element-wise multiplication)</p><p><strong>Adjoint operation</strong>: <span>$S^H y = \sum_{c=1}^{N_c} \bar{s}_c \odot y_c$</span> (coil combination)</p><p>Where <span>$s_c$</span> is the sensitivity map for coil <span>$c$</span>, <span>$\odot$</span> denotes element-wise multiplication, <span>$N_c$</span> is the number of coils, and <span>$\bar{s}_c$</span> is the complex conjugate of <span>$s_c$</span>.</p><h4 id="2.-Fourier-Transform-Operator-(ℱ)"><a class="docs-heading-anchor" href="#2.-Fourier-Transform-Operator-(ℱ)">2. Fourier Transform Operator (ℱ)</a><a id="2.-Fourier-Transform-Operator-(ℱ)-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Fourier-Transform-Operator-(ℱ)" title="Permalink"></a></h4><p>Transforms between image and k-space:</p><p class="math-container">\[\mathcal{F}: \mathbb{C}^{N_x \times N_y \times [N_z]} \rightarrow \mathbb{C}^{N_x \times N_y \times [N_z]}\]</p><p><strong>Forward operation</strong>: Discrete Fourier Transform (DFT) <strong>Adjoint operation</strong>: Inverse DFT (scaled appropriately)</p><h4 id="3.-Subsampling-Operator-(Γ)"><a class="docs-heading-anchor" href="#3.-Subsampling-Operator-(Γ)">3. Subsampling Operator (Γ)</a><a id="3.-Subsampling-Operator-(Γ)-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Subsampling-Operator-(Γ)" title="Permalink"></a></h4><p>Selects observed k-space locations according to an undersampling pattern:</p><p class="math-container">\[\Gamma: \mathbb{C}^{N_x \times N_y \times [N_z]} \rightarrow \mathbb{C}^{|\Omega|}\]</p><p>Where <span>$\Omega$</span> is the set of sampled k-space locations.</p><h2 id="Reconstruction-as-Inverse-Problem"><a class="docs-heading-anchor" href="#Reconstruction-as-Inverse-Problem">Reconstruction as Inverse Problem</a><a id="Reconstruction-as-Inverse-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Reconstruction-as-Inverse-Problem" title="Permalink"></a></h2><p>The most simple way of reconstructing the image <span>$x$</span> from observed data <span>$y$</span> is to apply the adjoint of the encoding operator:</p><p class="math-container">\[E^H y = \mathcal{S}^H \mathcal{F}^H \Gamma^H y\]</p><p>For fully sampled data without noise, this gives the least-squares solution. However, in practice, data is often undersampled and noisy, making direct inversion ill-posed. To address this, we formulate the reconstruction as a regularized inverse problem, formulated as:</p><p class="math-container">\[\hat{x} = \arg\min_x \frac{1}{2}\|Ex - y\|_2^2 + \lambda R(x)\]</p><p>Where:</p><ul><li><span>$\frac{1}{2}\|Ex - y\|_2^2$</span> is the data fidelity term</li><li><span>$R(x)$</span> is a regularization term (e.g., sparsity, total variation)</li><li><span>$\lambda$</span> controls the regularization strength</li></ul><p>The encoding operator <span>$E$</span> makes this optimization problem well-defined and computationally tractable.</p><h3 id="Regularization-Techniques"><a class="docs-heading-anchor" href="#Regularization-Techniques">Regularization Techniques</a><a id="Regularization-Techniques-1"></a><a class="docs-heading-anchor-permalink" href="#Regularization-Techniques" title="Permalink"></a></h3><p>The regularization term <span>$R(x)$</span> can take various forms depending on the desired image properties:</p><ul><li><strong>L2 Regularization</strong>: <span>$R(x) = \|x\|_2^2$</span> -&gt; Promotes smoothness</li><li><strong>L1 Wavelet Regularization</strong>: <span>$R(x) = \|\Psi x\|_1$</span> where <span>$\Psi$</span> is a wavelet transform -&gt; Promotes sparsity in the wavelet domain</li><li><strong>Total Variation (TV)</strong>: <span>$R(x) = \|\nabla x\|_1$</span> -&gt; Preserves edges while reducing noise</li></ul><p>The regularization terms are represented by a (linear) operator and a norm function in general:</p><p class="math-container">\[R(x) = f(\mathcal{T} x)\]</p><p>where <span>$\mathcal{T}$</span> is some transform operator and <span>$f$</span> is a norm function (e.g., L1, L2, nuclear norm, etc.).</p><h3 id="Optimization-Algorithms"><a class="docs-heading-anchor" href="#Optimization-Algorithms">Optimization Algorithms</a><a id="Optimization-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Algorithms" title="Permalink"></a></h3><p>Various iterative algorithms can be employed to solve the regularized inverse problem, most commonly:</p><ul><li><strong>Gradient Descent</strong> (usually conjugate gradient): If <span>$R(x)$</span> is differentiable</li><li><strong>Proximal Gradient Methods</strong>: For non-differentiable <span>$R(x)$</span></li></ul><p>Proximal gradient methods alternate between gradient descent on the data fidelity term and applying the proximal operator of the regularization term. The proximal operator is defined as:</p><p class="math-container">\[\text{prox}_{\alpha R}(v) = \arg\min_x \frac{1}{2}\|x - v\|_2^2 + \alpha R(x)\]</p><p>While it is inefficient to solve this minimization directly, many common regularization terms have closed-form proximal operators. For example, the proximal operator for L1 regularization is soft-thresholding:</p><p class="math-container">\[\text{prox}_{\alpha \|\cdot\|_1}(v) = \text{sign}(v) \odot \max(|v| - \alpha, 0)\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../high-level/acquisition_info/">AcquisitionInfo »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Wednesday 19 November 2025 02:24">Wednesday 19 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
